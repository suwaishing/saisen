/**
 * Minified by jsDelivr using UglifyJS v3.0.24.
 * Original file: /npm/three-gltf2-loader@1.2.0/lib/main.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";module.exports=function(e){e.GLTFLoader=function(){function a(a){this.manager=void 0!==a?a:e.DefaultLoadingManager}function r(){var e={};return{get:function(a){return e[a]},add:function(a,r){e[a]=r},remove:function(a){delete e[a]},removeAll:function(){e={}},update:function(a,r){for(var t in e){var n=e[t];n.update&&n.update(a,r)}}}}function t(a){this.name=f.KHR_LIGHTS,this.lights={};var r=(a.extensions&&a.extensions[f.KHR_LIGHTS]||{}).lights||{};for(var t in r){var n,s=r[t],i=(new e.Color).fromArray(s.color);switch(s.type){case"directional":(n=new e.DirectionalLight(i)).position.set(0,0,1);break;case"point":n=new e.PointLight(i);break;case"spot":(n=new e.SpotLight(i)).position.set(0,0,1);break;case"ambient":n=new e.AmbientLight(i)}n&&(void 0!==s.constantAttenuation&&(n.intensity=s.constantAttenuation),void 0!==s.linearAttenuation&&(n.distance=1/s.linearAttenuation),void 0!==s.quadraticAttenuation&&(n.decay=s.quadraticAttenuation),void 0!==s.fallOffAngle&&(n.angle=s.fallOffAngle),void 0!==s.fallOffExponent&&console.warn("THREE.GLTFLoader:: light.fallOffExponent not currently supported."),n.name=s.name||"light_"+t,this.lights[t]=n)}}function n(e){this.name=f.KHR_MATERIALS_COMMON}function s(e){this.name=f.KHR_BINARY_GLTF,this.content=null,this.body=null;var a=new DataView(e,0,h);if(this.header={magic:u(new Uint8Array(e.slice(0,4))),version:a.getUint32(4,!0),length:a.getUint32(8,!0)},this.header.magic!==m)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use GLTFLoader instead.");for(var r=new DataView(e,h),t=0;t<r.byteLength;){var n=r.getUint32(t,!0);t+=4;var s=r.getUint32(t,!0);if(t+=4,s===v.JSON){var i=new Uint8Array(e,h+t,n);this.content=u(i)}else if(s===v.BIN){var o=h+t;this.body=e.slice(o,o+n)}t+=n}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function i(){return{name:f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,getMaterialType:function(){return e.ShaderMaterial},extendParams:function(a,r,t){var n=r.extensions[this.name],s=e.ShaderLib.standard,i=e.UniformsUtils.clone(s.uniforms),o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),p=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),d=s.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",p);delete i.roughness,delete i.metalness,delete i.roughnessMap,delete i.metalnessMap,i.specular={value:(new e.Color).setHex(1118481)},i.glossiness={value:.5},i.specularMap={value:null},i.glossinessMap={value:null},a.vertexShader=s.vertexShader,a.fragmentShader=d,a.uniforms=i,a.defines={STANDARD:""},a.color=new e.Color(1,1,1),a.opacity=1;var f=[];if(Array.isArray(n.diffuseFactor)){var m=n.diffuseFactor;a.color.fromArray(m),a.opacity=m[3]}if(void 0!==n.diffuseTexture&&f.push(t.assignTexture(a,"map",n.diffuseTexture.index)),a.emissive=new e.Color(0,0,0),a.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,a.specular=new e.Color(1,1,1),Array.isArray(n.specularFactor)&&a.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var h=n.specularGlossinessTexture.index;f.push(t.assignTexture(a,"glossinessMap",h)),f.push(t.assignTexture(a,"specularMap",h))}return Promise.all(f)},createMaterial:function(a){var r=new e.ShaderMaterial({defines:a.defines,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,uniforms:a.uniforms,fog:!0,lights:!0,opacity:a.opacity,transparent:a.transparent});return r.isGLTFSpecularGlossinessMaterial=!0,r.color=a.color,r.map=void 0===a.map?null:a.map,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=void 0===a.aoMap?null:a.aoMap,r.aoMapIntensity=1,r.emissive=a.emissive,r.emissiveIntensity=1,r.emissiveMap=void 0===a.emissiveMap?null:a.emissiveMap,r.bumpMap=void 0===a.bumpMap?null:a.bumpMap,r.bumpScale=1,r.normalMap=void 0===a.normalMap?null:a.normalMap,r.normalScale=new e.Vector2(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=void 0===a.specularMap?null:a.specularMap,r.specular=a.specular,r.glossinessMap=void 0===a.glossinessMap?null:a.glossinessMap,r.glossiness=a.glossiness,r.alphaMap=null,r.envMap=void 0===a.envMap?null:a.envMap,r.envMapIntensity=1,r.refractionRatio=.98,r.extensions.derivatives=!0,r},refreshUniforms:function(e,a,r,t,n,s){var i=n.uniforms,o=n.defines;i.opacity.value=n.opacity,i.diffuse.value.copy(n.color),i.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),i.map.value=n.map,i.specularMap.value=n.specularMap,i.alphaMap.value=n.alphaMap,i.lightMap.value=n.lightMap,i.lightMapIntensity.value=n.lightMapIntensity,i.aoMap.value=n.aoMap,i.aoMapIntensity.value=n.aoMapIntensity;var l;if(n.map?l=n.map:n.specularMap?l=n.specularMap:n.displacementMap?l=n.displacementMap:n.normalMap?l=n.normalMap:n.bumpMap?l=n.bumpMap:n.glossinessMap?l=n.glossinessMap:n.alphaMap?l=n.alphaMap:n.emissiveMap&&(l=n.emissiveMap),void 0!==l){l.isWebGLRenderTarget&&(l=l.texture);var u=l.offset,c=l.repeat;i.offsetRepeat.value.set(u.x,u.y,c.x,c.y)}i.envMap.value=n.envMap,i.envMapIntensity.value=n.envMapIntensity,i.flipEnvMap.value=n.envMap&&n.envMap.isCubeTexture?-1:1,i.refractionRatio.value=n.refractionRatio,i.specular.value.copy(n.specular),i.glossiness.value=n.glossiness,i.glossinessMap.value=n.glossinessMap,i.emissiveMap.value=n.emissiveMap,i.bumpMap.value=n.bumpMap,i.normalMap.value=n.normalMap,i.displacementMap.value=n.displacementMap,i.displacementScale.value=n.displacementScale,i.displacementBias.value=n.displacementBias,null!==i.glossinessMap.value&&void 0===o.USE_GLOSSINESSMAP&&(o.USE_GLOSSINESSMAP="",o.USE_ROUGHNESSMAP=""),null===i.glossinessMap.value&&void 0!==o.USE_GLOSSINESSMAP&&(delete o.USE_GLOSSINESSMAP,delete o.USE_ROUGHNESSMAP)}}}function o(e,a,r){if(!e)return Promise.resolve();var t,n=[];if("[object Array]"===Object.prototype.toString.call(e)){t=[];for(var s=e.length,i=0;i<s;i++)(l=a.call(r||this,e[i],i))&&(n.push(l),l instanceof Promise?l.then(function(e,a){t[e]=a}.bind(this,i)):t[i]=l)}else{t={};for(var o in e)if(e.hasOwnProperty(o)){var l=a.call(r||this,e[o],o);l&&(n.push(l),l instanceof Promise?l.then(function(e,a){t[e]=a}.bind(this,o)):t[o]=l)}}return Promise.all(n).then(function(){return t})}function l(e,a){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(a||"")+e}function u(e){if(void 0!==window.TextDecoder)return(new TextDecoder).decode(e);for(var a="",r=0,t=e.length;r<t;r++)a+=String.fromCharCode(e[r]);return a}function c(){return new e.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:e.FrontSide})}function p(e,a,r,t){var n=e.geometry,s=e.material,i=r.targets,o=n.morphAttributes;o.position=[],o.normal=[],s.morphTargets=!0;for(var l=0,u=i.length;l<u;l++){var c,p,d=i[l],f="morphTarget"+l;if(void 0!==d.POSITION){c=t.accessors[d.POSITION].clone();for(var m=n.attributes.position,h=0,v=c.count;h<v;h++)c.setXYZ(h,c.getX(h)+m.getX(h),c.getY(h)+m.getY(h),c.getZ(h)+m.getZ(h))}else c=n.attributes.position.clone();if(void 0!==d.NORMAL){s.morphNormals=!0,p=t.accessors[d.NORMAL].clone();for(var g=n.attributes.normal,h=0,v=p.count;h<v;h++)p.setXYZ(h,p.getX(h)+g.getX(h),p.getY(h)+g.getY(h),p.getZ(h)+g.getZ(h))}else p=n.attributes.normal.clone();d.TANGENT,c.name=f,p.name=f,o.position.push(c),o.normal.push(p)}if(e.updateMorphTargets(),void 0!==a.weights)for(var l=0,u=a.weights.length;l<u;l++)e.morphTargetInfluences[l]=a.weights[l]}function d(e,a,t){this.json=e||{},this.extensions=a||{},this.options=t||{},this.cache=new r}a.prototype={constructor:a,crossOrigin:"Anonymous",load:function(a,r,t,n){var s=this,i=this.path&&"string"==typeof this.path?this.path:e.Loader.prototype.extractUrlBase(a),o=new e.FileLoader(s.manager);o.setResponseType("arraybuffer"),o.load(a,function(e){try{s.parse(e,i,r,n)}catch(e){n(e.constructor===Error?e:new Error("THREE.GLTFLoader: Unable to parse model."))}},t,n)},setCrossOrigin:function(e){this.crossOrigin=e},setPath:function(e){this.path=e},parse:function(e,a,r,o){var l,c={};u(new Uint8Array(e,0,4))===m?(c[f.KHR_BINARY_GLTF]=new s(e),l=c[f.KHR_BINARY_GLTF].content):l=u(new Uint8Array(e));var p=JSON.parse(l);void 0===p.asset||p.asset.version[0]<2?o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")):(p.extensionsUsed&&(p.extensionsUsed.indexOf(f.KHR_LIGHTS)>=0&&(c[f.KHR_LIGHTS]=new t(p)),p.extensionsUsed.indexOf(f.KHR_MATERIALS_COMMON)>=0&&(c[f.KHR_MATERIALS_COMMON]=new n(p)),p.extensionsUsed.indexOf(f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(c[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new i)),console.time("GLTFLoader"),new d(p,c,{path:a||this.path,crossOrigin:this.crossOrigin}).parse(function(e,a,t,n){console.timeEnd("GLTFLoader"),r({scene:e,scenes:a,cameras:t,animations:n})},o))}};var f={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_COMMON:"KHR_materials_common",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness"};n.prototype.getMaterialType=function(a){switch(a.extensions[this.name].type){case"commonBlinn":case"commonPhong":return e.MeshPhongMaterial;case"commonLambert":return e.MeshLambertMaterial;case"commonConstant":default:return e.MeshBasicMaterial}},n.prototype.extendParams=function(a,r,t){var n=r.extensions[this.name],s=[],i=[];switch(n.type){case"commonBlinn":case"commonPhong":i.push("diffuseFactor","diffuseTexture","specularFactor","specularTexture","shininessFactor");break;case"commonLambert":i.push("diffuseFactor","diffuseTexture")}var o={};return i.forEach(function(e){void 0!==n[e]&&(o[e]=n[e])}),void 0!==o.diffuseFactor&&(a.color=(new e.Color).fromArray(o.diffuseFactor),a.opacity=o.diffuseFactor[3]),void 0!==o.diffuseTexture&&s.push(t.assignTexture(a,"map",o.diffuseTexture.index)),void 0!==o.specularFactor&&(a.specular=(new e.Color).fromArray(o.specularFactor)),void 0!==o.specularTexture&&s.push(t.assignTexture(a,"specularMap",o.specularTexture.index)),void 0!==o.shininessFactor&&(a.shininess=o.shininessFactor),Promise.all(s)};var m="glTF",h=12,v={JSON:1313821514,BIN:5130562},g={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},M=(Number,e.Matrix3,e.Matrix4,e.Vector2,e.Vector3,e.Vector4,e.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),S={9728:e.NearestFilter,9729:e.LinearFilter,9984:e.NearestMipMapNearestFilter,9985:e.LinearMipMapNearestFilter,9986:e.NearestMipMapLinearFilter,9987:e.LinearMipMapLinearFilter},T={33071:e.ClampToEdgeWrapping,33648:e.MirroredRepeatWrapping,10497:e.RepeatWrapping},L={6406:e.AlphaFormat,6407:e.RGBFormat,6408:e.RGBAFormat,6409:e.LuminanceFormat,6410:e.LuminanceAlphaFormat},A={5121:e.UnsignedByteType,32819:e.UnsignedShort4444Type,32820:e.UnsignedShort5551Type,33635:e.UnsignedShort565Type},y=(e.BackSide,e.FrontSide,e.NeverDepth,e.LessDepth,e.EqualDepth,e.LessEqualDepth,e.GreaterEqualDepth,e.NotEqualDepth,e.GreaterEqualDepth,e.AlwaysDepth,e.AddEquation,e.SubtractEquation,e.ReverseSubtractEquation,e.ZeroFactor,e.OneFactor,e.SrcColorFactor,e.OneMinusSrcColorFactor,e.SrcAlphaFactor,e.OneMinusSrcAlphaFactor,e.DstAlphaFactor,e.OneMinusDstAlphaFactor,e.DstColorFactor,e.OneMinusDstColorFactor,e.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),E={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},R={CATMULLROMSPLINE:e.InterpolateSmooth,CUBICSPLINE:e.InterpolateSmooth,LINEAR:e.InterpolateLinear,STEP:e.InterpolateDiscrete},w={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};return d.prototype._withDependencies=function(e){for(var a={},r=0;r<e.length;r++){var t=e[r],n="load"+t.charAt(0).toUpperCase()+t.slice(1),s=this.cache.get(t);if(void 0!==s)a[t]=s;else if(this[n]){var i=this[n]();this.cache.add(t,i),a[t]=i}}return o(a,function(e){return e})},d.prototype.parse=function(e,a){var r=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(a){var t=[];for(var n in a.scenes)t.push(a.scenes[n]);var s=void 0!==r.scene?a.scenes[r.scene]:t[0],i=[];for(var n in a.cameras){var o=a.cameras[n];i.push(o)}var l=[];for(var n in a.animations)l.push(a.animations[n]);e(s,t,i,l)}).catch(a)},d.prototype.getDependency=function(e,a){var r=e+":"+a,t=this.cache.get(r);return t||(t=this["load"+e.charAt(0).toUpperCase()+e.slice(1)](a),this.cache.add(r,t)),t},d.prototype.loadBuffer=function(a){var r=this.json.buffers[a];if(r.type&&"arraybuffer"!==r.type)throw new Error("THREE.GLTFLoader: %s buffer type is not supported.",r.type);if(void 0===r.uri&&0===a)return Promise.resolve(this.extensions[f.KHR_BINARY_GLTF].body);var t=this.options;return new Promise(function(a){var n=new e.FileLoader;n.setResponseType("arraybuffer"),n.load(l(r.uri,t.path),a)})},d.prototype.loadBufferView=function(e){var a=this.json.bufferViews[e];return this.getDependency("buffer",a.buffer).then(function(e){var r=a.byteLength||0,t=a.byteOffset||0;return e.slice(t,t+r)})},d.prototype.loadAccessors=function(){var a=this,r=this.json;return o(r.accessors,function(t){return a.getDependency("bufferView",t.bufferView).then(function(a){var n,s=y[t.type],i=M[t.componentType],o=i.BYTES_PER_ELEMENT,l=o*s,u=r.bufferViews[t.bufferView].byteStride;if(u&&u!==l){n=new i(a);var c=new e.InterleavedBuffer(n,u/o);return new e.InterleavedBufferAttribute(c,s,t.byteOffset/o)}return n=new i(a,t.byteOffset,t.count*s),new e.BufferAttribute(n,s)})})},d.prototype.loadTexture=function(a){var r=this,t=this.json,n=this.options,s=window.URL||window.webkitURL,i=t.textures[a],o=t.images[i.source],u=o.uri,c=!1;return void 0!==o.bufferView&&(u=r.getDependency("bufferView",o.bufferView).then(function(e){c=!0;var a=new Blob([e],{type:o.mimeType});return u=s.createObjectURL(a)})),Promise.resolve(u).then(function(a){var r=e.Loader.Handlers.get(a)||new e.TextureLoader;return r.setCrossOrigin(n.crossOrigin),new Promise(function(e,t){r.load(l(a,n.path),e,void 0,t)})}).then(function(a){void 0!==c&&s.revokeObjectURL(u),a.flipY=!1,void 0!==i.name&&(a.name=i.name),a.format=void 0!==i.format?L[i.format]:e.RGBAFormat,void 0!==i.internalFormat&&a.format!==L[i.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),a.type=void 0!==i.type?A[i.type]:e.UnsignedByteType;var r=(t.samplers||{})[i.sampler]||{};return a.magFilter=S[r.magFilter]||e.LinearFilter,a.minFilter=S[r.minFilter]||e.LinearMipMapLinearFilter,a.wrapS=T[r.wrapS]||e.RepeatWrapping,a.wrapT=T[r.wrapT]||e.RepeatWrapping,a})},d.prototype.assignTexture=function(e,a,r){return this.getDependency("texture",r).then(function(r){e[a]=r})},d.prototype.loadMaterials=function(){var a=this,r=this.json,t=this.extensions;return o(r.materials,function(r){var n,s={},i=r.extensions||{},o=[];if(i[f.KHR_MATERIALS_COMMON]){var l=t[f.KHR_MATERIALS_COMMON];n=l.getMaterialType(r),o.push(l.extendParams(s,r,a))}else if(i[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=t[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];n=u.getMaterialType(r),o.push(u.extendParams(s,r,a))}else if(void 0!==r.pbrMetallicRoughness){n=e.MeshStandardMaterial;var c=r.pbrMetallicRoughness;if(s.color=new e.Color(1,1,1),s.opacity=1,Array.isArray(c.baseColorFactor)){var p=c.baseColorFactor;s.color.fromArray(p),s.opacity=p[3]}if(void 0!==c.baseColorTexture&&o.push(a.assignTexture(s,"map",c.baseColorTexture.index)),s.metalness=void 0!==c.metallicFactor?c.metallicFactor:1,s.roughness=void 0!==c.roughnessFactor?c.roughnessFactor:1,void 0!==c.metallicRoughnessTexture){var d=c.metallicRoughnessTexture.index;o.push(a.assignTexture(s,"metalnessMap",d)),o.push(a.assignTexture(s,"roughnessMap",d))}}else n=e.MeshPhongMaterial;!0===r.doubleSided&&(s.side=e.DoubleSide);var m=r.alphaMode||w.OPAQUE;return s.transparent=m!==w.OPAQUE,void 0!==r.normalTexture&&o.push(a.assignTexture(s,"normalMap",r.normalTexture.index)),void 0!==r.occlusionTexture&&o.push(a.assignTexture(s,"aoMap",r.occlusionTexture.index)),void 0!==r.emissiveFactor&&(n===e.MeshBasicMaterial?s.color=(new e.Color).fromArray(r.emissiveFactor):s.emissive=(new e.Color).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&(n===e.MeshBasicMaterial?o.push(a.assignTexture(s,"map",r.emissiveTexture.index)):o.push(a.assignTexture(s,"emissiveMap",r.emissiveTexture.index))),Promise.all(o).then(function(){var a;return a=n===e.ShaderMaterial?t[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new n(s),void 0!==r.name&&(a.name=r.name),a.normalScale.x=-1,a.userData=r.extras,a})})},d.prototype.loadGeometries=function(a){return this._withDependencies(["accessors"]).then(function(r){return o(a,function(a){var t=new e.BufferGeometry,n=a.attributes;for(var s in n){var i=n[s];if(void 0===i)return;var o=r.accessors[i];switch(s){case"POSITION":t.addAttribute("position",o);break;case"NORMAL":t.addAttribute("normal",o);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":t.addAttribute("uv",o);break;case"TEXCOORD_1":t.addAttribute("uv2",o);break;case"COLOR_0":case"COLOR0":case"COLOR":t.addAttribute("color",o);break;case"WEIGHTS_0":case"WEIGHT":t.addAttribute("skinWeight",o);break;case"JOINTS_0":case"JOINT":t.addAttribute("skinIndex",o)}}return void 0!==a.indices&&t.setIndex(r.accessors[a.indices]),t})})},d.prototype.loadMeshes=function(){var a=this,r=this.json;return this._withDependencies(["accessors","materials"]).then(function(t){return o(r.meshes,function(r){var n=new e.Group;void 0!==r.name&&(n.name=r.name),r.extras&&(n.userData=r.extras);var s=r.primitives||[];return a.loadGeometries(s).then(function(a){for(var i in s){var o=s[i],l=a[i],u=void 0===o.material?c():t.materials[o.material];u.aoMap&&void 0===l.attributes.uv2&&void 0!==l.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),l.addAttribute("uv2",new e.BufferAttribute(l.attributes.uv.array,2))),void 0!==l.attributes.color&&(u.vertexColors=e.VertexColors,u.needsUpdate=!0),void 0===l.attributes.normal&&(void 0!==u.flatShading?u.flatShading=!0:u.shading=e.FlatShading);var d;if(o.mode===g.TRIANGLES||void 0===o.mode)d=new e.Mesh(l,u);else if(o.mode===g.TRIANGLE_STRIP)(d=new e.Mesh(l,u)).drawMode=e.TriangleStripDrawMode;else if(o.mode===g.TRIANGLE_FAN)(d=new e.Mesh(l,u)).drawMode=e.TriangleFanDrawMode;else if(o.mode===g.LINES)d=new e.LineSegments(l,u);else if(o.mode===g.LINE_STRIP)d=new e.Line(l,u);else if(o.mode===g.LINE_LOOP)d=new e.LineLoop(l,u);else{if(o.mode!==g.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: ",o.mode);d=new e.Points(l,u)}d.name=n.name+"_"+i,void 0!==o.targets&&p(d,r,o,t),o.extras&&(d.userData=o.extras),n.add(d)}return n})})})},d.prototype.loadCameras=function(){return o(this.json.cameras,function(a){var r,t=a[a.type];if(t){if("perspective"===a.type){var n=t.aspectRatio||1,s=t.yfov*n;r=new e.PerspectiveCamera(e.Math.radToDeg(s),n,t.znear||1,t.zfar||2e6)}else"orthographic"===a.type&&(r=new e.OrthographicCamera(t.xmag/-2,t.xmag/2,t.ymag/2,t.ymag/-2,t.znear,t.zfar));return void 0!==a.name&&(r.name=a.name),a.extras&&(r.userData=a.extras),r}console.warn("THREE.GLTFLoader: Missing camera parameters.")})},d.prototype.loadSkins=function(){var e=this.json;return this._withDependencies(["accessors"]).then(function(a){return o(e.skins,function(e){return{joints:e.joints,inverseBindMatrices:a.accessors[e.inverseBindMatrices]}})})},d.prototype.loadAnimations=function(){var a=this.json;return this._withDependencies(["accessors","nodes"]).then(function(r){return o(a.animations,function(a,t){var n=[];for(var s in a.channels){var i=a.channels[s],o=a.samplers[i.sampler];if(o){var l=i.target,u=void 0!==l.node?l.node:l.id,c=void 0!==a.parameters?a.parameters[o.input]:o.input,p=void 0!==a.parameters?a.parameters[o.output]:o.output,d=r.accessors[c],f=r.accessors[p],m=r.nodes[u];if(m){m.updateMatrix(),m.matrixAutoUpdate=!0;var h;switch(E[l.path]){case E.weights:h=e.NumberKeyframeTrack;break;case E.rotation:h=e.QuaternionKeyframeTrack;break;case E.position:case E.scale:default:h=e.VectorKeyframeTrack}var v=m.name?m.name:m.uuid;"CATMULLROMSPLINE"===o.interpolation&&console.warn("THREE.GLTFLoader: CATMULLROMSPLINE interpolation is not supported. Using CUBICSPLINE instead.");var g=void 0!==o.interpolation?R[o.interpolation]:e.InterpolateLinear,M=[];E[l.path]===E.weights?m.traverse(function(e){!0===e.isMesh&&!0===e.material.morphTargets&&M.push(e.name?e.name:e.uuid)}):M.push(v);for(var S=0,T=M.length;S<T;S++)n.push(new h(M[S]+"."+E[l.path],e.AnimationUtils.arraySlice(d.array,0),e.AnimationUtils.arraySlice(f.array,0),g))}}}u=void 0!==a.name?a.name:"animation_"+t;return new e.AnimationClip(u,void 0,n)})})},d.prototype.loadNodes=function(){var a=this.json,r=this.extensions,t=this,n=a.nodes||[];return(a.skins||[]).forEach(function(e){e.joints.forEach(function(e){n[e].isBone=!0})}),o(a.nodes,function(a){var r=new e.Matrix4,t=!0===a.isBone?new e.Bone:new e.Object3D;return void 0!==a.name&&(t.name=e.PropertyBinding.sanitizeNodeName(a.name)),a.extras&&(t.userData=a.extras),void 0!==a.matrix?(r.fromArray(a.matrix),t.applyMatrix(r)):(void 0!==a.translation&&t.position.fromArray(a.translation),void 0!==a.rotation&&t.quaternion.fromArray(a.rotation),void 0!==a.scale&&t.scale.fromArray(a.scale)),t}).then(function(n){return t._withDependencies(["meshes","skins","cameras"]).then(function(t){return o(n,function(s,i){var o,l=a.nodes[i];if(void 0!==l.mesh?o=[l.mesh]:void 0!==l.meshes&&(console.warn("THREE.GLTFLoader: Legacy glTF file detected. Nodes may have no more than one mesh."),o=l.meshes),void 0!==o)for(var u in o){var c=o[u],p=t.meshes[c];if(void 0!==p){var d=p.clone(!1);for(var m in p.children){var h=p.children[m],v=h,g=h.material,M=h.geometry,S=h.morphTargetInfluences,T=h.userData,L=h.name,A=g;switch(h.type){case"LineSegments":h=new e.LineSegments(M,A);break;case"LineLoop":h=new e.LineLoop(M,A);break;case"Line":h=new e.Line(M,A);break;case"Points":h=new e.Points(M,A);break;default:(h=new e.Mesh(M,A)).drawMode=v.drawMode}h.castShadow=!0,h.morphTargetInfluences=S,h.userData=T,h.name=L;var y;if(void 0!==l.skin&&(y=t.skins[l.skin]),y){var E=M;(A=g).skinning=!0,(h=new e.SkinnedMesh(E,A)).castShadow=!0,h.userData=T,h.name=L;for(var R=[],w=[],x=0,_=y.joints.length;x<_;x++){var b=y.joints[x],F=n[b];if(F){R.push(F);var I=y.inverseBindMatrices.array,O=(new e.Matrix4).fromArray(I,16*x);w.push(O)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',b)}h.bind(new e.Skeleton(R,w),h.matrixWorld)}d.add(h)}s.add(d)}else console.warn('THREE.GLTFLoader: Could not find node "'+c+'".')}if(void 0!==l.camera){var G=t.cameras[l.camera];s.add(G)}if(l.extensions&&l.extensions[f.KHR_LIGHTS]&&void 0!==l.extensions[f.KHR_LIGHTS].light){var N=r[f.KHR_LIGHTS].lights;s.add(N[l.extensions[f.KHR_LIGHTS].light])}return s})})})},d.prototype.loadScenes=function(){function a(e,t,n){var s=n[e];t.add(s);var i=r.nodes[e];if(i.children)for(var o=i.children,l=0,u=o.length;l<u;l++)a(o[l],s,n)}var r=this.json,t=this.extensions;return this._withDependencies(["nodes"]).then(function(n){return o(r.scenes,function(r){var s=new e.Scene;void 0!==r.name&&(s.name=r.name),r.extras&&(s.userData=r.extras);for(var i=r.nodes||[],o=0,l=i.length;o<l;o++)a(i[o],s,n.nodes);if(s.traverse(function(e){e.material&&e.material.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=t[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}),r.extensions&&r.extensions[f.KHR_LIGHTS]&&void 0!==r.extensions[f.KHR_LIGHTS].light){var u=t[f.KHR_LIGHTS].lights;s.add(u[r.extensions[f.KHR_LIGHTS].light])}return s})})},a}()};
//# sourceMappingURL=/sm/20df71c6b2a55d0a11090762baf4d40c432df3522629d1d81870202f97a681a1.map